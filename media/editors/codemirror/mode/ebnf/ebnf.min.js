!function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],a):a(CodeMirror)}(function(a){"use strict";a.defineMode("ebnf",function(b){var c={slash:0,parenthesis:1},d={comment:0,_string:1,characterClass:2},e=null;return b.bracesMode&&(e=a.getMode(b,b.bracesMode)),{startState:function(){return{stringType:null,commentType:null,braced:0,lhs:!0,localState:null,stack:[],inDefinition:!1}},token:function(a,b){if(a){switch(0===b.stack.length&&('"'==a.peek()||"'"==a.peek()?(b.stringType=a.peek(),a.next(),b.stack.unshift(d._string)):a.match(/^\/\*/)?(b.stack.unshift(d.comment),b.commentType=c.slash):a.match(/^\(\*/)&&(b.stack.unshift(d.comment),b.commentType=c.parenthesis)),b.stack[0]){case d._string:for(;b.stack[0]===d._string&&!a.eol();)a.peek()===b.stringType?(a.next(),b.stack.shift()):"\\"===a.peek()?(a.next(),a.next()):a.match(/^.[^\\\"\']*/);return b.lhs?"property string":"string";case d.comment:for(;b.stack[0]===d.comment&&!a.eol();)b.commentType===c.slash&&a.match(/\*\//)?(b.stack.shift(),b.commentType=null):b.commentType===c.parenthesis&&a.match(/\*\)/)?(b.stack.shift(),b.commentType=null):a.match(/^.[^\*]*/);return"comment";case d.characterClass:for(;b.stack[0]===d.characterClass&&!a.eol();)a.match(/^[^\]\\]+/)||a.match(/^\\./)||b.stack.shift();return"operator"}var f=a.peek();if(null!==e&&(b.braced||"{"===f)){null===b.localState&&(b.localState=e.startState());var g=e.token(a,b.localState),h=a.current();if(!g)for(var i=0;i<h.length;i++)"{"===h[i]?(0===b.braced&&(g="matchingbracket"),b.braced++):"}"===h[i]&&(b.braced--,0===b.braced&&(g="matchingbracket"));return g}switch(f){case"[":return a.next(),b.stack.unshift(d.characterClass),"bracket";case":":case"|":case";":return a.next(),"operator";case"%":if(a.match("%%"))return"header";if(a.match(/[%][A-Za-z]+/))return"keyword";if(a.match(/[%][}]/))return"matchingbracket";break;case"/":if(a.match(/[\/][A-Za-z]+/))return"keyword";case"\\":if(a.match(/[\][a-z]+/))return"string-2";case".":if(a.match("."))return"atom";case"*":case"-":case"+":case"^":if(a.match(f))return"atom";case"$":if(a.match("$$"))return"builtin";if(a.match(/[$][0-9]+/))return"variable-3";case"<":if(a.match(/<<[a-zA-Z_]+>>/))return"builtin"}return a.match(/^\/\//)?(a.skipToEnd(),"comment"):a.match(/return/)?"operator":a.match(/^[a-zA-Z_][a-zA-Z0-9_]*/)?a.match(/(?=[\(.])/)?"variable":a.match(/(?=[\s\n]*[:=])/)?"def":"variable-2":-1!=["[","]","(",")"].indexOf(a.peek())?(a.next(),"bracket"):(a.eatSpace()||a.next(),null)}}}}),a.defineMIME("text/x-ebnf","ebnf")});